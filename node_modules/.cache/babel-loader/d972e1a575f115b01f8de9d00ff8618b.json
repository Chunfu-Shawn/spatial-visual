{"ast":null,"code":"import _defineProperty from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _createForOfIteratorHelper from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _classCallCheck from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { getSizeChannel, POSITION_SCALE_CHANNELS } from '../channel';\nimport { isFieldOrDatumDef } from '../channeldef';\nimport * as log from '../log';\nimport { isUnitSpec } from '../spec/unit';\nimport { isEmpty } from '../util';\nexport var RangeStepNormalizer = /*#__PURE__*/function () {\n  function RangeStepNormalizer() {\n    _classCallCheck(this, RangeStepNormalizer);\n\n    this.name = 'RangeStep';\n  }\n\n  _createClass(RangeStepNormalizer, [{\n    key: \"hasMatchingType\",\n    value: function hasMatchingType(spec) {\n      var _a;\n\n      if (isUnitSpec(spec) && spec.encoding) {\n        var _iterator = _createForOfIteratorHelper(POSITION_SCALE_CHANNELS),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var channel = _step.value;\n            var def = spec.encoding[channel];\n\n            if (def && isFieldOrDatumDef(def)) {\n              if ((_a = def === null || def === void 0 ? void 0 : def.scale) === null || _a === void 0 ? void 0 : _a['rangeStep']) {\n                return true;\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"run\",\n    value: function run(spec) {\n      var _a;\n\n      var sizeMixins = {};\n      var encoding = Object.assign({}, spec.encoding);\n\n      var _iterator2 = _createForOfIteratorHelper(POSITION_SCALE_CHANNELS),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var channel = _step2.value;\n          var sizeType = getSizeChannel(channel);\n          var def = encoding[channel];\n\n          if (def && isFieldOrDatumDef(def)) {\n            if ((_a = def === null || def === void 0 ? void 0 : def.scale) === null || _a === void 0 ? void 0 : _a['rangeStep']) {\n              var scale = def.scale,\n                  defWithoutScale = __rest(def, [\"scale\"]);\n\n              var _b = scale,\n                  rangeStep = _b.rangeStep,\n                  scaleWithoutRangeStep = __rest(_b, [\"rangeStep\"]);\n\n              sizeMixins[sizeType] = {\n                step: scale['rangeStep']\n              };\n              log.warn(log.message.RANGE_STEP_DEPRECATED);\n              encoding = Object.assign(Object.assign({}, encoding), _defineProperty({}, channel, Object.assign(Object.assign({}, defWithoutScale), isEmpty(scaleWithoutRangeStep) ? {} : {\n                scale: scaleWithoutRangeStep\n              })));\n            }\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return Object.assign(Object.assign(Object.assign({}, sizeMixins), spec), {\n        encoding: encoding\n      });\n    }\n  }]);\n\n  return RangeStepNormalizer;\n}();","map":{"version":3,"sources":["../../../src/normalize/rangestep.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { getSizeChannel, POSITION_SCALE_CHANNELS } from '../channel';\nimport { isFieldOrDatumDef } from '../channeldef';\nimport * as log from '../log';\nimport { isUnitSpec } from '../spec/unit';\nimport { isEmpty } from '../util';\nexport class RangeStepNormalizer {\n    constructor() {\n        this.name = 'RangeStep';\n    }\n    hasMatchingType(spec) {\n        var _a;\n        if (isUnitSpec(spec) && spec.encoding) {\n            for (const channel of POSITION_SCALE_CHANNELS) {\n                const def = spec.encoding[channel];\n                if (def && isFieldOrDatumDef(def)) {\n                    if ((_a = def === null || def === void 0 ? void 0 : def.scale) === null || _a === void 0 ? void 0 : _a['rangeStep']) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n    run(spec) {\n        var _a;\n        const sizeMixins = {};\n        let encoding = Object.assign({}, spec.encoding);\n        for (const channel of POSITION_SCALE_CHANNELS) {\n            const sizeType = getSizeChannel(channel);\n            const def = encoding[channel];\n            if (def && isFieldOrDatumDef(def)) {\n                if ((_a = def === null || def === void 0 ? void 0 : def.scale) === null || _a === void 0 ? void 0 : _a['rangeStep']) {\n                    const { scale } = def, defWithoutScale = __rest(def, [\"scale\"]);\n                    const _b = scale, { rangeStep } = _b, scaleWithoutRangeStep = __rest(_b, [\"rangeStep\"]);\n                    sizeMixins[sizeType] = { step: scale['rangeStep'] };\n                    log.warn(log.message.RANGE_STEP_DEPRECATED);\n                    encoding = Object.assign(Object.assign({}, encoding), { [channel]: Object.assign(Object.assign({}, defWithoutScale), (isEmpty(scaleWithoutRangeStep) ? {} : { scale: scaleWithoutRangeStep })) });\n                }\n            }\n        }\n        return Object.assign(Object.assign(Object.assign({}, sizeMixins), spec), { encoding });\n    }\n}\n//# sourceMappingURL=rangestep.js.map"]},"metadata":{},"sourceType":"module"}