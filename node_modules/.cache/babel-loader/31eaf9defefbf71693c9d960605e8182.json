{"ast":null,"code":"import _regeneratorRuntime from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/chunfu/IdeaProjects/spatial-visual/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { ChildProcessProxy } from '@loaders.gl/worker-utils';\nvar MODULE_ROOT = \"\".concat(__dirname, \"/../../..\");\nexport function encodeImageURLToCompressedTextureURL(_x, _x2) {\n  return _encodeImageURLToCompressedTextureURL.apply(this, arguments);\n}\n\nfunction _encodeImageURLToCompressedTextureURL() {\n  _encodeImageURLToCompressedTextureURL = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(inputUrl, outputUrl) {\n    var args, childProcess;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            args = ['texture-compressor', '--type', 's3tc', '--compression', 'DXT1', '--quality', 'normal', '--input', inputUrl, '--output', outputUrl];\n            childProcess = new ChildProcessProxy();\n            _context.next = 4;\n            return childProcess.start({\n              command: 'npx',\n              arguments: args,\n              spawn: {\n                cwd: MODULE_ROOT\n              }\n            });\n\n          case 4:\n            return _context.abrupt(\"return\", outputUrl);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _encodeImageURLToCompressedTextureURL.apply(this, arguments);\n}","map":{"version":3,"sources":["../../../../src/lib/encoders/encode-texture.ts"],"names":["MODULE_ROOT","args","childProcess","command","arguments","spawn","cwd"],"mappings":";;AAAA,SAAA,iBAAA,QAAA,0BAAA;AAEA,IAAMA,WAAW,GAAA,GAAA,MAAA,CAAA,SAAA,EAAjB,WAAiB,CAAjB;AAKA,gBAAO,oCAAP;AAAA;AAAA;;;mGAAO,iBAAA,QAAA,EAAA,SAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAECC,YAAAA,IAFD,GAEQ,CAAA,oBAAA,EAAA,QAAA,EAAA,MAAA,EAAA,eAAA,EAAA,MAAA,EAAA,WAAA,EAAA,QAAA,EAAA,SAAA,EAAA,QAAA,EAAA,UAAA,EAAb,SAAa,CAFR;AAWCC,YAAAA,YAXD,GAWgB,IAArB,iBAAqB,EAXhB;AAAA;AAAA,mBAYC,YAAY,CAAZ,KAAA,CAAmB;AACvBC,cAAAA,OAAO,EADgB,KAAA;AAEvBC,cAAAA,SAAS,EAFc,IAAA;AAGvBC,cAAAA,KAAK,EAAE;AACLC,gBAAAA,GAAG,EAAEN;AADA;AAHgB,aAAnB,CAZD;;AAAA;AAAA,6CAmBL,SAnBK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import {ChildProcessProxy} from '@loaders.gl/worker-utils';\n\nconst MODULE_ROOT = `${__dirname}/../../..`;\n\n/*\n * @see https://github.com/TimvanScherpenzeel/texture-compressor\n */\nexport async function encodeImageURLToCompressedTextureURL(inputUrl, outputUrl) {\n  // prettier-ignore\n  const args = [\n    // Note: our actual executable is `npx`, so `texture-compressor` is an argument\n    'texture-compressor',\n    '--type', 's3tc',\n    '--compression', 'DXT1',\n    '--quality', 'normal',\n    '--input', inputUrl,\n    '--output', outputUrl\n  ];\n  const childProcess = new ChildProcessProxy();\n  await childProcess.start({\n    command: 'npx',\n    arguments: args,\n    spawn: {\n      cwd: MODULE_ROOT\n    }\n  });\n  return outputUrl;\n}\n"]},"metadata":{},"sourceType":"module"}